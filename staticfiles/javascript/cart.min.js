document.addEventListener("DOMContentLoaded",function(){async function t(t,o,n={}){try{const c=await fetch(t,{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify(n)}),r=await c.json();r.success&&e(o,r.quantity,r.total_price,r.cart_total,r.cart_total_items)}catch(t){console.error("Error:",t)}}function e(t,e,n,c,r){const a=document.querySelector(`.product-item[data-product-id="${t}"]`);if(a){const t=a.querySelector(".cart-quantity"),o=a.querySelector(".remove-from-cart");t&&(t.textContent=e),o&&(o.style.display=e>0?"inline-block":"none")}const i=document.querySelector(`.cart-item[data-product-id="${t}"]`);if(i){const t=i.querySelector(".item-quantity span"),o=i.querySelector(".item-total");t&&(t.textContent=e),o&&(o.textContent=`Ksh.${n}`)}const u=document.querySelector(`.summary-item[data-product-id="${t}"]`);if(u){const t=u.querySelector(".summary-item-quantity"),o=u.querySelector(".summary-item-total");t&&(t.textContent=`Quantity: ${e}`),o&&(o.textContent=`Ksh.${n}`)}const s=document.querySelector(".summary-total span:last-child");s&&(s.textContent=`Ksh.${c}`);const d=document.querySelector(".summary-subtotal span:last-child");d&&(d.textContent=`Ksh.${c}`),o(r)}function o(t){const e=document.querySelector(".cart-counter");e&&(e.textContent=t,e.style.display=t>0?"block":"none")}document.querySelectorAll(".cart-btn").forEach(e=>{e.addEventListener("click",function(){const e=this.dataset.productId;t(`/add-to-cart/${e}/`,e)})}),document.querySelectorAll(".remove-from-cart").forEach(e=>{e.addEventListener("click",function(){const e=this.dataset.productId;t(`/remove-from-cart/${e}/`,e)})}),document.querySelectorAll(".quantity-btn").forEach(e=>{e.addEventListener("click",function(){const e=this.dataset.productId,o="+"===this.textContent.trim(),n=o?`/add-to-cart/${e}/`:`/remove-from-cart/${e}/`;t(n,e)})}),"undefined"!=typeof initialCartCount?o(initialCartCount):console.warn("initialCartCount is not defined. Cart counter may not be initialized correctly.")});